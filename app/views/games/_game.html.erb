<div id="<%= dom_id game %>" class="card">
  <div class="row">
    <%= avatar_image_tag(game.name, url: game.avatar_url) %>
    <div>
      <div style="display:flex; align-items:baseline; gap:8px;">
        <strong><%= link_to game.name, game %></strong>
        <% st = game.status %>
        <% if st == :ongoing %>
          <span class="badge badge--green">идёт</span>
        <% elsif st == :upcoming %>
          <span class="badge badge--blue">скоро</span>
        <% elsif st == :past %>
          <span class="badge badge--gray">прошла</span>
        <% end %>
      </div>

      <p style="margin:4px 0 0 0;" class="muted">
        <%= game.organizer %>
      </p>

      <p style="margin:6px 0 0 0;">
        <strong>Период:</strong>
        <%= game.starts_at %> — <%= game.ends_at %>
      </p>

      <p style="margin:6px 0 0 0;">
        <strong>Регистрация:</strong>
        <% case game.registration_status
           when :open %>
             <span class="badge badge--green">открыта</span>
        <%   when :upcoming %>
             <span class="badge badge--blue">скоро</span>
        <%   when :closed %>
             <span class="badge badge--gray">закрыта</span>
        <%   else %>
             <span class="badge badge--gray">не задано</span>
        <% end %>
        <% if game.registration_opens_at || game.registration_closes_at %>
          <span class="muted">
            (<%= game.registration_opens_at || '—' %> — <%= game.registration_closes_at || '—' %>)
          </span>
        <% end %>
      </p>

      <p style="margin:6px 0 0 0;">
        <strong>Scoreboard:</strong>
        <% case game.scoreboard_status
           when :open, :always %>
             <span class="badge badge--green">открыт</span>
        <%   when :upcoming %>
             <span class="badge badge--blue">скоро</span>
        <%   when :closed %>
             <span class="badge badge--gray">закрыт</span>
        <% end %>
        <% if game.scoreboard_opens_at || game.scoreboard_closes_at %>
          <span class="muted">
            (<%= game.scoreboard_opens_at || '—' %> — <%= game.scoreboard_closes_at || '—' %>)
          </span>
        <% end %>
      </p>

      <% if game.site_url.present? || game.ctftime_url.present? %>
        <p class="muted" style="margin:6px 0 0 0;">
          <% if game.site_url.present? %>
            <%= link_to 'Сайт', game.site_url, target: '_blank', rel: 'noopener' %>
          <% end %>
          <% if game.ctftime_url.present? %>
            <% if game.site_url.present? %> • <% end %>
            <%= link_to 'CTFtime', game.ctftime_url, target: '_blank', rel: 'noopener' %>
          <% end %>
        </p>
      <% end %>

      <% if game.services.any? %>
        <p style="margin:8px 0 0 0;">
          <strong>Сервисы:</strong>
          <%= game.services.order(:name).map { |s| link_to s.name, s }.join(' • ').html_safe %>
        </p>
      <% end %>
    </div>
  </div>
</div>
