<div id="<%= dom_id service %>">
  <div style="display:flex; align-items:center; gap:10px;">
    <% url = service.avatar_url.to_s.strip %>
    <% if url.present? && (url.start_with?('http://', 'https://', '/') || url.start_with?('data:image')) %>
      <%= image_tag url, alt: service.name, class: 'avatar-image' %>
    <% else %>
      <% initial = service.name.to_s.first&.upcase || '?' %>
      <span class="avatar-circle" aria-label="avatar"><%= initial %></span>
    <% end %>
    <div>
      <strong><%= service.name %></strong>
      <% if service.public %>
        <span class="badge badge--green">public</span>
      <% else %>
        <span class="badge badge--gray">private</span>
      <% end %>
    </div>
  </div>

  <p style="margin: 6px 0 0 0;">
    <em><%= service.author %></em>
  </p>

  <div style="margin-top:8px;">
    <div><strong>Public description:</strong> <%= service.public_description %></div>
    <% if user_signed_in? && current_user.role == 'admin' %>
      <div style="margin-top:4px; color:#666;"><strong>Private:</strong> <%= service.private_description %></div>
    <% end %>
  </div>

  <% if user_signed_in? && current_user.role == 'admin' %>
    <div style="margin-top:8px;">
      <% if service.public %>
        <%= button_to 'Сделать приватным', toggle_public_service_path(service), method: :post %>
      <% else %>
        <%= button_to 'Сделать публичным', toggle_public_service_path(service), method: :post %>
      <% end %>
    </div>
  <% end %>

</div>
